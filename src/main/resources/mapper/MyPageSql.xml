<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.MyPageMapper">
    <!--    user(회원) 테이블에 관한 CRUD -->
    <select id="userByName" parameterType="String" resultType="UserDto">
        select *
        from user
        where u_name = #{u_name}
    </select>
    <select id="userByNum" parameterType="int" resultType="UserDto">
        select *
        from user
        where u_num = #{u_num}
    </select>

    <!--    trade(주문내역) CRUD-->
    <!--    검색한 목록의 총 갯수-->
    <select id="tradeTotalCount" parameterType="Map" resultType="int">
        select count(*)
        from trade
        where u_num = #{u_num}
        <if test="state!=null">
            and state=#{state}
        </if>
    </select>
    <!--    검색한 목록의 총 금액-->
    <select id="tradeTotalPrice" parameterType="Map" resultType="int">
        select sum(count * lastprice)
        from trade
        where u_num = #{u_num}
    </select>
    <!--    검색한 목록 출력-->
    <select id="tradePagingByU_num" parameterType="Map" resultType="TradeDto">
        select * from trade where u_num=#{u_num} order by day desc
        <if test="startNum!=null and perPage!=null">
            limit #{startNum},#{perPage}
        </if>
    </select>
    <!--    -->
</mapper>